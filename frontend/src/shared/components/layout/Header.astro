---
import { ThemeToggle } from "./ThemeToggle";
---

<header
  id="main-header"
  class="fixed top-0 left-0 right-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 transition-all duration-300"
>
  <div class="flex h-16 items-center px-6 max-w-full">
    <!-- Logo -->
    <a href="/" class="flex items-center space-x-2 mr-6">
      <img src="/logo.png" alt="Ailurus" class="h-8 w-8 pixel-art" />
      <span class="font-bold text-lg hidden sm:inline-block">Ailurus</span>
    </a>

    <!-- Navigation Desktop -->
    <nav
      class="hidden md:flex items-center space-x-6 text-sm font-medium flex-1"
    >
      <a
        href="/docs"
        class="transition-colors hover:text-foreground/80 text-foreground/60"
      >
        Documentación
      </a>
      <a
        href="/search"
        class="transition-colors hover:text-foreground/80 text-foreground/60"
      >
        Buscar
      </a>
      <a
        href="https://github.com/yourusername/ailurus"
        target="_blank"
        rel="noopener noreferrer"
        class="transition-colors hover:text-foreground/80 text-foreground/60"
      >
        GitHub
      </a>
    </nav>

    <!-- Right Side Actions -->
    <div class="flex flex-1 items-center justify-end space-x-2">
      <!-- Quick Search Button (opens /search page) -->
      <button
        onclick="window.location.href='/search'"
        class="hidden md:flex items-center gap-2 px-3 py-1.5 text-sm text-muted-foreground border rounded-md hover:bg-accent hover:text-accent-foreground transition-colors"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.3-4.3"></path>
        </svg>
        <span>Buscar...</span>
        <kbd
          class="pointer-events-none inline-flex h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium text-muted-foreground opacity-100"
        >
          <span class="text-xs">⌘</span>K
        </kbd>
        <span class="sr-only">Buscar</span>
      </button>

      <!-- Theme Toggle -->
      <ThemeToggle client:load />

      <!-- Mobile Menu Button -->
      <button
        id="mobile-menu-button"
        class="md:hidden inline-flex items-center justify-center rounded-md text-sm font-medium h-9 w-9 hover:bg-accent hover:text-accent-foreground"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <line x1="4" x2="20" y1="12" y2="12"></line>
          <line x1="4" x2="20" y1="6" y2="6"></line>
          <line x1="4" x2="20" y1="18" y2="18"></line>
        </svg>
        <span class="sr-only">Menú</span>
      </button>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div id="mobile-menu" class="hidden border-t md:!hidden">
    <nav class="py-4 px-6 flex flex-col space-y-3">
      <a
        href="/docs"
        class="text-sm font-medium transition-colors hover:text-foreground/80 text-foreground/60"
      >
        Documentación
      </a>
      <a
        href="/search"
        class="text-sm font-medium transition-colors hover:text-foreground/80 text-foreground/60"
      >
        Buscar
      </a>
      <a
        href="https://github.com/yourusername/ailurus"
        target="_blank"
        rel="noopener noreferrer"
        class="text-sm font-medium transition-colors hover:text-foreground/80 text-foreground/60"
      >
        GitHub
      </a>
    </nav>
  </div>
</header>

<style>
  #main-header.scrolled {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    background: hsl(var(--background));
  }

  :global(.dark) #main-header.scrolled {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
  }
</style>

<script>
  // Mobile menu toggle
  const button = document.getElementById("mobile-menu-button");
  const menu = document.getElementById("mobile-menu");

  // Keyboard shortcut for search (Cmd+K / Ctrl+K)
  document.addEventListener("keydown", (e) => {
    if ((e.metaKey || e.ctrlKey) && e.key === "k") {
      e.preventDefault();
      window.location.href = "/search";
    }
  });

  button?.addEventListener("click", () => {
    menu?.classList.toggle("hidden");

    // Cerrar menú al hacer click en un enlace
    const links = menu?.querySelectorAll("a");
    links?.forEach((link) => {
      link.addEventListener("click", () => {
        menu?.classList.add("hidden");
      });
    });
  });

  // Scroll behavior for header - add shadow when scrolling
  const header = document.getElementById("main-header");

  function handleScroll() {
    const currentScrollY = window.scrollY;

    if (!header) return;

    if (currentScrollY > 10) {
      // Add shadow when scrolling
      header.classList.add("scrolled");
    } else {
      // Remove shadow at top
      header.classList.remove("scrolled");
    }
  }

  // Throttle scroll events for better performance
  let ticking = false;
  window.addEventListener("scroll", () => {
    if (!ticking) {
      window.requestAnimationFrame(() => {
        handleScroll();
        ticking = false;
      });
      ticking = true;
    }
  });
</script>
